<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=iso-8859-1">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./rev1_fichiers/filelist.xml">
<link rel=Edit-Time-Data href="./rev1_fichiers/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Untitled Document</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Fred</o:Author>
  <o:LastAuthor>Fred</o:LastAuthor>
  <o:Revision>5</o:Revision>
  <o:TotalTime>45</o:TotalTime>
  <o:Created>2001-07-21T10:06:00Z</o:Created>
  <o:LastSaved>2002-07-25T23:22:00Z</o:LastSaved>
  <o:Pages>4</o:Pages>
  <o:Words>1217</o:Words>
  <o:Characters>6940</o:Characters>
  <o:Company>NoSoCiETy</o:Company>
  <o:Lines>57</o:Lines>
  <o:Paragraphs>13</o:Paragraphs>
  <o:CharactersWithSpaces>8522</o:CharactersWithSpaces>
  <o:Version>9.2812</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:HyphenationZone>21</w:HyphenationZone>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;}
a:link, span.MsoHyperlink
	{color:#3333FF;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
p
	{margin-right:0cm;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:70.85pt 70.85pt 70.85pt 70.85pt;
	mso-header-margin:35.4pt;
	mso-footer-margin:35.4pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1027">
  <o:colormenu v:ext="edit" fillcolor="black"/>
 </o:shapedefaults></xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body bgcolor=black lang=FR link="#3333ff" vlink=blue style='tab-interval:35.4pt'>

<div class=Section1>

  <div class=MsoNormal align=center style='text-align:center'><span
style='color:silver'> 
    <hr size=2 width="100%" align=center>
    </span><span style='color:white'><o:p></o:p></span></div>


<p align=center style='text-align:center'><b><span style='color:white'>Sujet :
Introduction au Reversing</span></b><span style='color:silver'><o:p></o:p></span></p>


<div class=MsoNormal align=center style='text-align:center'><span
style='color:silver'>

<hr size=2 width="100%" align=center>

</span></div>


<p><b><span style='color:white'>Intro:</span></b><span style='color:white'><o:p></o:p></span></p>

<p><span style='color:silver'>Le cracking est disons l'art de faire sauter les
sécurités d'un programme afin de pouvoir l'utiliser librement et gratuitement.<br>
Tandis que le reversing est l'art de modifier un programme afin de lui ajouter
des fonctions ou bien d'optimiser certaines routines ou encore de détourner un
programme pour d'autres applications que celles pour lequel il a été conçu ou
pourquoi pas encore de le customiser selon nos désirs.<br>
Bref, si le cracking n'exige pas de grandes connaissances en programmation et
en assembleur, le reversing lui en requiert quelques bonnes bases.<br>
Je vous invite donc à consulter les cours d'Iczelion sur la programmation en
W32asm qui sont tout simplement les meilleurs.( www.w32asm.fr ).<br>
Une bonne connaissance des API ainsi que du fonctionnement de Windows est aussi
nécessaire, pour ça le mieux étant de vous mettre à la programmation.<o:p></o:p></span></p>

<p><b><span style='color:white'>Thème :</span></b><span style='color:white'><o:p></o:p></span></p>

<p><span style='color:silver'>Pour cette introduction on va commencer par
simple et rapide, le programme que nous allons reverser est le Bloc-Note de
Windows celui-ci étant une très bonne base pour s'entraîner. Nous allons tout
simplement ajouté à celui-ci un message qui s'affichera au lancement du prog.
pour nous souhaiter la bienvenue.<o:p></o:p></span></p>

<p><b><span style='color:white'>Outils nécessaire</span></b><b><span
style='color:silver'> : <br>
</span></b><span style='color:silver'>- W32Dasm9x<br>
- Hiew 6.xx<o:p></o:p></span></p>

<p><b><span style='color:white'>Plan d'attaque</span></b><b><span
style='color:silver'> :</span></b><span style='color:silver'><o:p></o:p></span></p>

<p><span style='color:silver'>Voici le schéma que nous allons suivre pour la
réalisation de ce projet :<o:p></o:p></span></p>

<p><span style='color:#FFCC99'>- 1/ Chercher un endroit libre dans l'exécutable
et y insérer notre code<br>
- 2/ Trouver l'Entry-Point du programme<br>
- 3/ Mettre un jump à l'Entry-Point pour sauter directement vers notre code et
relever les instructions que notre jump écrasera<br>
- 4/ A la fin de notre code mettre les instructions que nous avons écrasés et
mettre un jump qui retourne au programme normal (après notre jump a l'entry
point) <o:p></o:p></span></p>

<p><span style='color:silver'>Ainsi notre programme au lancement sautera
directement vers nos instructions qui afficheront une MessageBox ensuite le
programme reprendra sont cours normal.<o:p></o:p></span></p>

<p><b><span style='color:silver'>1/ Chercher un endroit libre dans l'exécutable
et y insérer notre code</span></b><span style='color:silver'><o:p></o:p></span></p>

<p><span style='color:silver'>A l'aide d'un éditeur Hexadécimal ouvrez
notepad.exe.<br>
Les emplacement vides sont repérer par des 00, donc on cherche une parcelle de
00 suffisamment grande pour contenir quelques lignes de codes.<br>
Pour cet exemple je me suis placé à l'offset <b>D954<br>
</b>A cette adresse on va inscrire notre message de bienvenue, on se place dans
la partie ascii de notre editeur et on tape<b> Bienvenue Netix</b>.<br>
On se placera ensuite à l'offset<b> D970 </b>pour y mettre les instructions.
Pour cela on va se servir <b>Hiew</b> qui nous permet d'écrire directement les
instructions en assembleur plutot que d'encoder avec des valeurs Hexadécimales.<o:p></o:p></span></p>

<p><span style='color:silver'>- On ouvre <b>Hiew<br>
- </b>on repère l'exécutable<br>
- F4 puis Décode<br>
- F5 puis l'adresse de notre code ( image base + offset ) 400000 + D970 =&gt;
.40D970 ( pas oublier le . avant l'adresse )</span><span style='color:#CCFFCC'><o:p></o:p></span></p>

<p><span style='color:silver'>Nous voulons afficher une MessageBox qui
contiendra notre texte &quot;Bienvenue Netix&quot;. Voici le prototype de l'API
MessageBox :<o:p></o:p></span></p>

<p><b><span lang=EN-GB style='color:#CCFFCC;mso-ansi-language:EN-GB'>int
MessageBox(<br>
HWND hWnd, </span></b><span lang=EN-GB style='color:#CCFFCC;mso-ansi-language:
EN-GB'>// handle of owner window <b><br>
LPCTSTR lpText,</b> // address of text in message box <b><br>
LPCTSTR lpCaption, //</b> address of title of message box <b><br>
UINT uType // </b>style of message box <b><br>
);</b><o:p></o:p></span></p>

<p><b><span style='color:silver'>int</span></b><span style='color:silver'>
désigne un entier qui recevra une valeur de retour de cette fonction pour
déterminer quel bouton à été pressé pour cette MessageBox , pour cette exemple
nous ne nous en serviront pas.<br>
<b>hWnd</b> désigne le propriétaire de cette fenêtre ici nous mettrons 0 pour
aucun <br>
<b>lpText</b> est un pointeur qui contiendra l'adresse de notre message ( l
offset de <b>Bienvenue Netix</b> )<br>
<b>lpCaption</b> est un pointeur qui contiendra l'adresse de notre titre pour
la MessageBox ( on mettra le même pour notre message )<br>
<b>uType</b> est un entier qui détermine le type de notre MessageBox ( l'icône,
quel type de boutons, etc...) ici on va mettre 0 pour obtenir une boite simple<o:p></o:p></span></p>

<p><span style='color:silver'>Ces 4 valeurs sont les arguments de la fonction <b>MessageBox</b>
, en assembleur pour passer les argument a une fonction on les pousse dans
l'odre dans la pile juste avant le call de la fonction<o:p></o:p></span></p>

<p><span style='color:#CCFFCC'>push 0 <br>
push 40D954 // notre texte<br>
push 40D954 // le titre de la boite de message<br>
push 0 // le type de boite 0 = simple<br>
call MessageBox // appelle la fonction<o:p></o:p></span></p>

<p><span style='color:silver'>Maintenant nous allons repéré dans le programme
la syntaxe en Hexadecimal du call pour une messagebox. <br>
A l'aide de W32Dasm on recherche dans les Imports User32.MessageBoxA puis on
clique dessus plusieurs fois , remarquez tout les call pour cette fonction ont
la même syntaxe en hexadécimal on la note donc.<o:p></o:p></span></p>

<p><span style='color:silver'>de retour sous <b>Hiew </b>a l'offset de notre
code (.40d970) on fait :<o:p></o:p></span></p>

<p><span style='color:#FFCC99'>- F3 pour passer en mode édition<br>
- F2 pour passer en mode assembleur<br>
- on entre donc nos instructions :<br>
- push 0 (puis touche Entrer pour chaque instructions)<br>
- push 40D954<br>
- push 40D954<br>
- push 0<br>
- Touche Echap pour quitter le mode assembleur<br>
- on entre la suite Hexadécimal pour notre call : FF15A8644000<br>
- il nous reste plus qu'a mettre un jmp pour sauter au début normal du
programme.<o:p></o:p></span></p>

<p><b><span style='color:silver'>2/ Trouver l'Entry-Point du programme</span></b><span
style='color:silver'><o:p></o:p></span></p>

<p><span style='color:silver'>Rien de plus simple.<br>
Dans le menu de W32dasm faite GOTO<b> </b>puis GOTO PROGRAM ENTRY POINT. Vous
arriver directement a l'adresse de celui-ci que l'on note.<br>
Ici <b>4010CC</b> <o:p></o:p></span></p>

<p><span style='color:silver'>L'Entry-Point est l'adresse de la première
instruction qui va s'effectuer lors du lancement du prog.<o:p></o:p></span></p>

<p><span style='color:silver'>&nbsp;<o:p></o:p></span></p>

<p><b><span style='color:silver'>3/ Mettre un jump à l'Entry-Point pour sauter
directement vers notre code</span></b><span style='color:silver'><o:p></o:p></span></p>

<p><span style='color:silver'>Tout d'abord on note les instructions qui vont
êtres écrasés par notre jump nous les replaceront a la fin de notre code ce qui
nous evitera le plantage .<o:p></o:p></span></p>

<p><span style='color:silver'>Sous <b>Hiew </b>on fait :<o:p></o:p></span></p>

<p><b><span style='color:silver'>Goto</span></b><span style='color:silver'>
(adresse de l'Entry-Point (.4010CC)) on passe en mode assembleur et on tape <b>jmp
D970</b><o:p></o:p></span></p>

<p><span style='color:silver'>D970 étant l'offset de la première instruction de
notre code repéré a l'aide d'un éditeur Hexa. <o:p></o:p></span></p>

<p><span style='color:silver'>&nbsp;<o:p></o:p></span></p>

<p><b><span style='color:silver'>4/ A la fin de notre code mettre un jump qui
retourne juste après l'Entry-Point</span></b><span style='color:silver'><o:p></o:p></span></p>

<p><span style='color:silver'>Avant de retourné vers l'Entry-point on replace
les instructions que notre jump a écrasé soit en Hexa :<o:p></o:p></span></p>

<p><span style='color:#FFCC99'>55<br>
8BEC<br>
83EC44<br>
56<o:p></o:p></span></p>

<p><span style='color:silver'>ensuite en mode assembleur on place notre jump<o:p></o:p></span></p>

<p><span style='color:silver'>jmp <b>10D3</b><o:p></o:p></span></p>

<p><span style='color:silver'>10D3 est l'offset ou le programme reprend sa
partie normale juste après notre jump a l'entry-point vers notre code. <o:p></o:p></span></p>


<div class=MsoNormal align=center style='text-align:center'><span
style='color:silver'>

<hr size=2 width="100%" align=center>

</span></div>


<p align=center style='text-align:center'><span style='color:silver'>Ce qui au
final donne ceci :<o:p></o:p></span></p>

<p align=center style='text-align:center'><span style='color:silver'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<div align=center>

<table border=1 cellpadding=0 width="67%" style='width:67.64%;mso-cellspacing:
 1.5pt;mso-padding-alt:0cm 0cm 0cm 0cm' height=214>
 <tr style='height:23.7pt'>
  <td style='padding:.75pt .75pt .75pt .75pt;height:23.7pt'>
  <p class=MsoNormal align=center style='text-align:center'><span lang=EN-GB
  style='color:#FFCC99;mso-ansi-language:EN-GB'>Listing Original <o:p></o:p></span></p>
  </td>
 </tr>
 <tr style='height:126.65pt'>
  <td style='padding:.75pt .75pt .75pt .75pt;height:126.65pt'>
  <p class=MsoNormal><span lang=EN-GB style='color:silver;mso-ansi-language:
  EN-GB'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class=MsoNormal><span lang=EN-GB style='color:silver;mso-ansi-language:
  EN-GB'>&nbsp;//******************** Program Entry Point ********<o:p></o:p></span></p>
  <p class=MsoNormal><span style='color:silver'>:004010CC 55<span
  style="mso-spacerun:
  yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>push ebp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>|<span style="mso-spacerun: yes">&nbsp; </span></span><span
  lang=EN-GB style='font-family:Wingdings;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman";color:silver;mso-ansi-language:EN-GB;
  mso-char-type:symbol;mso-symbol-font-family:Wingdings'><span
  style='mso-char-type:symbol;mso-symbol-font-family:Wingdings'>ß</span></span><span
  style='color:silver'> La on placera notre jump<o:p></o:p></span></p>
  <p class=MsoNormal><span style='color:silver'>:004010CD 8BEC<span
  style="mso-spacerun:
  yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>mov ebp, esp<span style="mso-spacerun:
  yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>|<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>Ces 4 instructions
  seront copié a la fin de notre <o:p></o:p></span></p>
  <p class=MsoNormal><span style='color:silver'>:004010CF 83EC44<span
  style="mso-spacerun:
  yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>sub esp, 00000044<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;
  </span>|<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>code<o:p></o:p></span></p>
  <p class=MsoNormal><span lang=EN-GB style='color:silver;mso-ansi-language:
  EN-GB'>:004010D2 56<span style="mso-spacerun:
  yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>push esi<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>|<o:p></o:p></span></p>
  <p class=MsoNormal><span style='color:silver'>:004010D3 FF15E0634000<span
  style="mso-spacerun: yes">&nbsp;&nbsp; </span>Call dword ptr [004063E0]<span
  style="mso-spacerun: yes">&nbsp; </span></span><span lang=DE
  style='font-family:Wingdings;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman";color:silver;mso-ansi-language:DE;
  mso-char-type:symbol;mso-symbol-font-family:Wingdings'><span
  style='mso-char-type:symbol;mso-symbol-font-family:Wingdings'>ß</span></span><span
  lang=DE style='color:silver'> </span><span style='color:silver'>notre code
  reviendra par un jump ici<o:p></o:p></span></p>
  <p class=MsoNormal><span lang=EN-GB style='color:silver;mso-ansi-language:
  EN-GB'>:004010D9 8BF0<span style="mso-spacerun:
  yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>mov esi, eax<o:p></o:p></span></p>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  lang=EN-GB style='color:silver;mso-ansi-language:EN-GB'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p align=center style='text-align:center'><span lang=EN-GB style='color:silver;
mso-ansi-language:EN-GB'>&nbsp;<o:p></o:p></span></p>

<div align=center>

<table border=1 cellpadding=0 width="66%" style='width:66.18%;mso-cellspacing:
 1.5pt;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr>
  <td width="99%" style='width:99.38%;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='color:#FFCC99'>Listing Modifié vu sous Hiew<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width="99%" style='width:99.38%;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal><span style='color:silver'>&nbsp;</span><span lang=EN-GB
  style='color:silver;mso-ansi-language:EN-GB'>//******************** Program
  Entry Point ********<o:p></o:p></span></p>
  <p class=MsoNormal><span style='color:silver'>:004010CC E99FC80000<span
  style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </span>jmp .40D970<span
  style="mso-spacerun: yes">&nbsp; </span></span><span lang=DE
  style='font-family:Wingdings;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman";color:silver;mso-ansi-language:DE;
  mso-char-type:symbol;mso-symbol-font-family:Wingdings'><span
  style='mso-char-type:symbol;mso-symbol-font-family:Wingdings'>ß</span></span><span
  style='color:silver'> Notre jump<o:p></o:p></span></p>
  <p class=MsoNormal><span style='color:silver'>:004010D1 44<span
  style="mso-spacerun:
  yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>inc esp<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;
  </span>|<o:p></o:p></span></p>
  <p class=MsoNormal><span style='color:silver'>:004010D2 56<span
  style="mso-spacerun:
  yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>push esi<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>|<span
  style="mso-spacerun: yes">&nbsp;&nbsp; </span>ces 2 instructions sont
  apparues suite au changement créer<span style="mso-spacerun:
  yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><o:p></o:p></span></p>
  <p class=MsoNormal><span style='color:silver'><span style="mso-spacerun:
  yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>par notre jump mais on s&#8217;en fiche pas mal puisque qu&#8217;elles<o:p></o:p></span></p>
  <p class=MsoNormal><span style='color:silver'><span style="mso-spacerun:
  yes">&nbsp;&nbsp; </span><span style="mso-spacerun:
  yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>ne
  seront jamais exécuter car notre après notre code un jump<o:p></o:p></span></p>
  <p class=MsoNormal><span style='color:silver'><span style="mso-spacerun:
  yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>reviendra juste après celles-ci.<o:p></o:p></span></p>
  <p class=MsoNormal><span style='color:silver'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>
  <p class=MsoNormal><span style='color:silver'>:004010D3 FF15E0634000<span
  style="mso-spacerun: yes">&nbsp;&nbsp; </span>Call GetCommandLine&nbsp;;USER32.dll
  </span><span lang=DE style='font-family:Wingdings;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman";color:silver;mso-ansi-language:DE;
  mso-char-type:symbol;mso-symbol-font-family:Wingdings'><span
  style='mso-char-type:symbol;mso-symbol-font-family:Wingdings'>ß</span></span><span
  style='color:silver'> C&#8217;est Ici le retour de notre code<o:p></o:p></span></p>
  <p class=MsoNormal><span lang=EN-GB style='color:silver;mso-ansi-language:
  EN-GB'>:004010D9 8BF0<span style="mso-spacerun:
  yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>mov esi, eax<o:p></o:p></span></p>
  <p class=MsoNormal><span style='color:silver'>........<o:p></o:p></span></p>
  <p class=MsoNormal><span style='color:silver'>........<o:p></o:p></span></p>
  <p class=MsoNormal><span style='color:silver'>//********************* Notre
  Code *************<o:p></o:p></span></p>
  <p class=MsoNormal><span style='color:silver'>.0040D970 6A00<span
  style="mso-spacerun:
  yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>push 00<span style="mso-spacerun:
  yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>|<o:p></o:p></span></p>
  <p class=MsoNormal><span style='color:silver'>.0040D972 6854D94000<span
  style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>push
  0040D954<span style="mso-spacerun: yes">&nbsp;&nbsp; </span>|<span
  style="mso-spacerun: yes">&nbsp;&nbsp; </span>Les 4 paramètres sur la pile
  pour la message box<o:p></o:p></span></p>
  <p class=MsoNormal><span lang=EN-GB style='color:silver;mso-ansi-language:
  EN-GB'>.0040D977 6854D94000<span style="mso-spacerun:
  yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>push 0040D954<span
  style="mso-spacerun: yes">&nbsp;&nbsp; </span>|<o:p></o:p></span></p>
  <p class=MsoNormal><span lang=EN-GB style='color:silver;mso-ansi-language:
  EN-GB'>.0040D97C 6A00<span style="mso-spacerun:
  yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>push 00<span style="mso-spacerun:
  yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>|<o:p></o:p></span></p>
  <p class=MsoNormal><span lang=EN-GB style='color:silver;mso-ansi-language:
  EN-GB'>.0040D97E FF15A8644000<span style="mso-spacerun: yes">&nbsp;
  </span>Call<span style="mso-spacerun: yes">&nbsp; </span>MessageBoxA ;
  User32.dll<span style="mso-spacerun: yes">&nbsp; </span></span><span
  lang=EN-GB style='font-family:Wingdings;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman";color:silver;mso-ansi-language:EN-GB;
  mso-char-type:symbol;mso-symbol-font-family:Wingdings'><span
  style='mso-char-type:symbol;mso-symbol-font-family:Wingdings'>ß</span></span><span
  lang=EN-GB style='color:silver;mso-ansi-language:EN-GB'> appelle la
  MessageBox<o:p></o:p></span></p>
  <p class=MsoNormal><span lang=EN-GB style='color:silver;mso-ansi-language:
  EN-GB'>.0040D984<span style="mso-spacerun: yes">&nbsp; </span>55<span
  style="mso-spacerun:
  yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>push ebp<span style="mso-spacerun:
  yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>|<o:p></o:p></span></p>
  <p class=MsoNormal><span lang=EN-GB style='color:silver;mso-ansi-language:
  EN-GB'>.0040D985<span style="mso-spacerun: yes">&nbsp; </span>8BEC<span
  style="mso-spacerun:
  yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>mov ebp, esp<span style="mso-spacerun:
  yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>|<span style="mso-spacerun: yes">&nbsp; </span>Les 4 Instructions
  qu&#8217;il y avait a l&#8217;entry point<o:p></o:p></span></p>
  <p class=MsoNormal><span style='color:silver'>.0040D987<span
  style="mso-spacerun: yes">&nbsp; </span>83EC44<span style="mso-spacerun:
  yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>sub esp, 00000044<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;
  </span>|<o:p></o:p></span></p>
  <p class=MsoNormal><span lang=EN-GB style='color:silver;mso-ansi-language:
  EN-GB'>.0040D98A<span style="mso-spacerun: yes">&nbsp; </span>56<span
  style="mso-spacerun:
  yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>push esi<span style="mso-spacerun:
  yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span>|<o:p></o:p></span></p>
  <p class=MsoNormal><span style='color:silver'>.0040D98B<span
  style="mso-spacerun: yes">&nbsp; </span>E94337FFFF<span style="mso-spacerun:
  yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>jmp .4010D3<span
  style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
  lang=DE style='font-family:Wingdings;mso-ascii-font-family:"Times New Roman";
  mso-hansi-font-family:"Times New Roman";color:silver;mso-ansi-language:DE;
  mso-char-type:symbol;mso-symbol-font-family:Wingdings'><span
  style='mso-char-type:symbol;mso-symbol-font-family:Wingdings'>ß</span></span><span
  style='color:silver'><span style="mso-spacerun: yes">&nbsp; </span>On
  retourne au déroulement normal du prog.<span style="mso-spacerun:
  yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span><o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>

<p align=center style='text-align:center'><span style='color:silver'>&nbsp;<o:p></o:p></span></p>

<p><span style='color:silver'>PS: N'essayer pas de trouver votre code sous
W32dasm , il n'y figurera pas du fait que les sections n'ont pas été modifié
suite au rajout de notre code mais ceci<br>
fait partis d'un prochain tutorial sur les sections et le PE-header<o:p></o:p></span></p>

<p>&nbsp;</p>

  <p align="center">&nbsp;</p>

<p>&nbsp;</p>

</div>

</body>

</html>
