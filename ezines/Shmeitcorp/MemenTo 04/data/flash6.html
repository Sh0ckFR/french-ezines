<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./Cracking_fichiers/filelist.xml">
<link rel=Edit-Time-Data href="./Cracking_fichiers/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title> </title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>fred-x</o:Author>
  <o:LastAuthor>Fred</o:LastAuthor>
  <o:Revision>14</o:Revision>
  <o:TotalTime>473</o:TotalTime>
  <o:Created>2001-06-27T16:36:00Z</o:Created>
  <o:LastSaved>2001-07-26T14:00:00Z</o:LastSaved>
  <o:Pages>4</o:Pages>
  <o:Words>1301</o:Words>
  <o:Characters>7417</o:Characters>
  <o:Company>NoSociety</o:Company>
  <o:Lines>61</o:Lines>
  <o:Paragraphs>14</o:Paragraphs>
  <o:CharactersWithSpaces>9108</o:CharactersWithSpaces>
  <o:Version>9.2812</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:HyphenationZone>21</w:HyphenationZone>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:windowtext;}
h1
	{mso-style-next:Normal;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:12.0pt;
	font-family:"Times New Roman";
	color:white;
	mso-font-kerning:0pt;
	font-weight:bold;
	font-style:italic;}
h2
	{mso-style-next:Normal;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:12.0pt;
	font-family:"Times New Roman";
	color:white;
	font-weight:bold;}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:#99CCFF;}
p.MsoBodyText2, li.MsoBodyText2, div.MsoBodyText2
	{margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;}
p.MsoBodyText3, li.MsoBodyText3, div.MsoBodyText3
	{margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;}
p
	{margin-right:0cm;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:white;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:70.85pt 70.85pt 70.85pt 70.85pt;
	mso-header-margin:35.4pt;
	mso-footer-margin:35.4pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
@list l0
	{mso-list-id:799684564;
	mso-list-type:hybrid;
	mso-list-template-ids:1103922682 -1778713020 67895299 67895301 67895297 67895299 67895301 67895297 67895299 67895301;}
@list l0:level1
	{mso-level-start-at:0;
	mso-level-number-format:bullet;
	mso-level-text:-;
	mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1027">
  <o:colormenu v:ext="edit" fillcolor="black"/>
 </o:shapedefaults></xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body bgcolor=black lang=FR style='tab-interval:35.4pt'>

<div class=Section1>

<div class=MsoNormal align=center style='text-align:center'><span
style='color:#999999'>

<hr size=2 width="100%" align=center>

</span></div>


  <p align=center style='text-align:center'>&nbsp;</p>
  <div align=center>
<table border=1 cellpadding=0 width="75%" style='width:75.0%;mso-cellspacing:
 1.5pt;mso-padding-alt:0cm 0cm 0cm 0cm'>
 <tr>
  <td width="32%" style='width:32.0%;padding:.75pt .75pt .75pt .75pt'>
  <h2>SUJET</h2>
  </td>
  <td width="68%" style='width:68.0%;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal align=center style='text-align:center'><span lang=EN-GB
  style='font-size:13.5pt;color:#99CCFF;mso-ansi-language:EN-GB'>Crack de
  MapDesigner 2.0 pro</span><span lang=EN-GB style='color:#99CCFF;mso-ansi-language:
  EN-GB'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width="32%" style='width:32.0%;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal align=center style='text-align:center'><b><span
  style='color:white'>TYPE DE PROTECTION</span></b><span style='color:white'><o:p></o:p></span></p>
  </td>
  <td width="68%" style='width:68.0%;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal align=center style='text-align:center'><span lang=EN-GB
  style='color:white;mso-ansi-language:EN-GB'>Crypted ASPack, nag-screen, save
  désactivé<o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width="32%" style='width:32.0%;padding:.75pt .75pt .75pt .75pt'>
  <h2>OUTILS UTILISES</h2>
  </td>
  <td width="68%" style='width:68.0%;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal align=center style='text-align:center'><span
  style='color:white'>UnAspack, procdump,W32dasm85, SoftIce, Hiew<o:p></o:p></span></p>
  </td>
 </tr>
</table>

</div>


<div class=MsoNormal align=center style='text-align:center'><span
style='color:#999999'>

<hr size=2 width="100%" align=center>

</span></div>


<p class=MsoNormal><span style='color:#999999'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><b><span style='color:white'>Intro&nbsp;:<o:p></o:p></span></b></p>

<p class=MsoNormal><span style='color:white'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='color:silver'>Ce crack requiert quelques bases
en cracking mais le niveau reste assez faible et est idéal pour s’initier aux
programmes cryptés.<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:silver'>Car oui ce<span
style="mso-spacerun: yes">  </span>programme est crypté et c’est vraiment la
seul difficulté pour le cracker et c’est ce qui donne l’intérêt de ce cours car
sinon le schema de protection du programme est tout ce qu’il ya de plus
classique (une variable detemine si l’on est enregistré et cette varaible est
testé à differents endroits).<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:silver'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='color:silver'>Je vous conseille de lires les
cours de Christal et Teeji sur les exe crypte et packed, pour ma part je me
suis largement inspire de celui de Teeji que je salut bien bas<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:silver'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='color:silver'>Tout d’abord il est hors de
question de décrypté ce prog de le cracker et puis basta….<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:silver'>Le but ici est de créer un patch
qui permettra de cracker la version originale (crypté).<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:silver'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='color:silver'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='color:silver'>Voici comment s’exécute un
programme crypté&nbsp;:<o:p></o:p></span></p>

<p class=MsoNormal><span style='color:silver'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:l0 level1 lfo2;
tab-stops:list 36.0pt'><![if !supportLists]><span style='color:silver'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='color:silver'>L’entry-point pointe vers les
instructions qui vont servir à décrypter le prog<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:l0 level1 lfo2;
tab-stops:list 36.0pt'><![if !supportLists]><span style='color:silver'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='color:silver'>Le programme<span
style="mso-spacerun: yes">  </span>se décrypte et se charge en mémoire<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:l0 level1 lfo2;
tab-stops:list 36.0pt'><![if !supportLists]><span style='color:silver'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='color:silver'>Une fois totalement
décrypté, il saute vers les routines normales d’exécution du prog<o:p></o:p></span></p>

<p><span style='font-size:10.0pt;font-family:"Courier New";color:#CCFFFF'>&nbsp;&nbsp;
<u>Rem</u> : Un entry-point, point d'entrée en français, est une adresse
virtuel relative correspondant à l'adresse de la première instruction que le
programme doit exécuter. Cette adresse est inscrite dans le PE-Header de
l'exécutable.<o:p></o:p></span></p>

<p><span style='font-size:10.0pt;font-family:"Courier New";color:#CCFFFF'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p><b><span style='mso-bidi-font-size:10.0pt'>Phase 1</span> / Decryptage<o:p></o:p></b></p>

<p><span style='color:silver'>D’abord comment sait-on que le programme est
crypté&nbsp;?<o:p></o:p></span></p>

<p><span style='color:silver'>Il y’a plusieurs symptômes&nbsp;:<o:p></o:p></span></p>

  <p style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:l0 level1 lfo2;
tab-stops:list 36.0pt'><![if !supportLists]><span style='color:silver'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    </span></span><![endif]><span style='color:silver'>quand on désassemble le 
    prog avec W32Dasm celui ci ne contient aucune ressources, ni import, ni strings 
    datas references<o:p><br>
    </o:p></span><![if !supportLists]><span style='color:silver'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    </span></span><![endif]><span style='color:silver'>du coté des sections sous 
    ProcDump une se nomme .aspack<o:p><br>
    </o:p></span><![if !supportLists]><span style='color:silver'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    </span></span><![endif]><span style='color:silver'>et si vous testez ce prog 
    avec un sniffeur de pack celui ci vous rapportera&nbsp;: crypted by ASPack<o:p></o:p></span></p>

<p><span style='color:silver'>On pourrait chercher les bytes a patcher
uniquement sous softice qui lui lit le prog en memoire donc décrypté, mais on
va se servir de W32Dasm et de ses précieuses datas string références mais pour
cela va falloir les decryptés et les rendre lisibles….<o:p></o:p></span></p>

<p><span style='color:silver'>On a le nom du crypteur, suffit de prendre son
decrypteur et voilà le boulot…. La plupart des crypteurs possèdent leur
descripteur que vous pourrez trouvez aisément sur des sites de cracks outillés.
<br>
On décrypte le prog à<span style="mso-spacerun: yes">  </span>l’aide de
UnAspack et on obtient un zoli exécutable de 1140 ko décrypté contre 421
(crypté). <br>
Sous proc-dump on va éditer les </span><span style='mso-bidi-font-size:10.0pt;
color:silver'>caractéristiques des</span><span style='font-size:10.0pt;
font-family:"Courier New";color:silver'> </span><span style='color:silver'>sections
afin de rendre les ressources lisibles.( c’est ce qui empêche W32Dasm d’obtenir
le code, les strings datas références, les imports ,etc.. )<o:p></o:p></span></p>

  <p style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:l0 level1 lfo2;
tab-stops:list 36.0pt'><![if !supportLists]><span style='color:silver'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    </span></span><![endif]><span style='color:silver'>on lance ProcDump<o:p><br>
    </o:p></span><![if !supportLists]><span style='color:silver'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    </span></span><![endif]><span style='color:silver'>on clike sur PE editor<o:p><br>
    </o:p></span><![if !supportLists]><span style='color:silver'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    </span></span><![endif]><span style='color:silver'>on select notre prog<o:p><br>
    </o:p></span><![if !supportLists]><span style='color:silver'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    </span></span><![endif]><span style='color:silver'>et on clike sur sections<o:p><br>
    </o:p></span><![if !supportLists]><span style='color:silver'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    </span></span><![endif]><span style='color:silver'>on peux voir que toutes 
    les sections ont comme </span><span style='mso-bidi-font-size:10.0pt;color:silver'>caractéristique 
    C0000040</span><span style='color:silver'><o:p><br>
    </o:p></span><![if !supportLists]><span style='color:silver'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    </span></span><![endif]><span style='mso-bidi-font-size:10.0pt;color:silver'>On 
    clike droit sur les sections .CODE et .DATA on fait édit section</span><span
style='color:silver'><o:p><br>
    </o:p></span><![if !supportLists]><span style='color:silver'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    </span></span><![endif]><span style='mso-bidi-font-size:10.0pt;color:silver'>Dans 
    section caractéristiques on met<span style="mso-spacerun: yes">  </span>E0000020 
    à la place de C0000040</span><span style='color:silver'><o:p><br>
    </o:p></span><![if !supportLists]><span style='color:silver'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    </span></span><![endif]><span style='mso-bidi-font-size:10.0pt;color:silver'>On 
    clike sur ok , et on quitte Proc-Dump</span><span style='color:silver'><o:p></o:p></span></p>

<p><span style='mso-bidi-font-size:10.0pt;color:silver'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p><b><span style='mso-bidi-font-size:10.0pt'>Phase 2 / Le Crack</span><o:p></o:p></b></p>

<p><span style='mso-bidi-font-size:10.0pt;color:silver'>Voilà, Maintenant on
prend W32Dasm85 je dis bien 85 car c’est la seul version qui ne soit réellement
efficace en ce qui qui concerne les Strings Datas References.<br>
Si vous essayé avec une version plus recentes vous n’en<span
style="mso-spacerun: yes">  </span>trouverez que tres peu et aucune
interressante tandis que sous la version 85 ou 6 vous aurez droit à une belle
liste ou vous pourrez trouver pas mal de strings dont une particulierement
interressante&nbsp;: [unregistered version]&nbsp;: Le pitit mot dans la barre
de titre…<o:p></o:p></span></p>

<p><span style='mso-bidi-font-size:10.0pt;color:silver'>On click sur cette
string et on obtient 2 references&nbsp;: Voici la premiere<o:p></o:p></span></p>

<p align=center style='text-align:center'><img width=491 height=302
id="_x0000_i1027" src=ck1.jpg></p>

<p>&nbsp;<span style='color:silver'>On voit que celle ci est appelé par un jump
à l’adresse 4D533F, on va voir a cette adresse et on obtient ceci&nbsp;:<o:p></o:p></span></p>

<p align=center style='text-align:center'><img width=753 height=334
id="_x0000_i1028" src=ck2.jpg><span style='color:silver'><o:p></o:p></span></p>

<p><span style='color:silver'>Ici on voit clairement qu’une adresse mémoire&nbsp;:
4E1128 (qui représente une variable de type boolean) est comparé avec 00 et si
la variable = 00 on saute vers la routine du code qui nous déclare unregistered.<br>
On va effectuer une recherche sur cette variable&nbsp;: 4E1128 , on obtient plusieurs
références, Ce qui nous intéresse c’est les endroit ou cette variable sera
initialisé donc avec les instructions MOV. On obtient 4 references dont une ou
elle initialisé avec 01 et <span style="mso-spacerun: yes"> </span>trois<span
style="mso-spacerun: yes">  </span>ou elle est initialisé avec 00<o:p></o:p></span></p>

<p><span style='color:silver'>Sachant que 00 nous envois vers unregistered , il
va falloir modifié ces trois adresses afin que la variable soit initialisé avec
01.<br>
On réalise cette opreation sous Hiew&nbsp;:<o:p></o:p></span></p>

  <p style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:l0 level1 lfo2;
tab-stops:list 36.0pt'><![if !supportLists]><span style='color:silver'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    </span></span><![endif]><span style='color:silver'>on fais F4 puis Decode<o:p><br>
    </o:p></span><![if !supportLists]><span style='color:silver'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    </span></span><![endif]><span style='color:silver'>F5 pour goto et on tape 
    les adresses que l’on à trouvé (si vous tapez l’adresse que vous avez lu dans 
    w32dasm n’oubliez pas le point devant celle-ci, exemple pour la premiere&nbsp;:<span
style="mso-spacerun: yes">  </span>on tape .4D2D54, si vous utilisé l’offset le 
    point ne doit pas figurer exemple pour la meme&nbsp;: on tape D2154 )<br>
    </span><![if !supportLists]><span style='color:silver'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    </span></span><![endif]><span style='color:silver'>F3 pour edit et F2 pour 
    passer en mode assembleur<o:p><br>
    </o:p></span><![if !supportLists]><span style='color:silver'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    </span></span><![endif]><span style='color:silver'>On remplace dans cette 
    instruction le 00 par 01<o:p><br>
    </o:p></span><![if !supportLists]><span style='color:silver'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    </span></span><![endif]><span style='color:silver'>Ensuite F9 pour valider<o:p><br>
    </o:p></span><![if !supportLists]><span style='color:silver'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
    </span></span><![endif]><span style='color:silver'>On fait pareil pour les 
    2 autres adresses<o:p></o:p></span></p>

<p><span style='color:silver'>On lance le programme, et la on est registered,
Le nag-screen à sauté et l’on peut sauvegarder alors que cette option n’etait
pas active.<br>
Et voilà le programme est cracké.<o:p></o:p></span></p>

  <p><b>Phase 3 / Realiser le pacth<o:p></o:p></b></p>

<p><span style='color:silver'>Maintenant comment faire pour realisé un patch
qui pourrait modifié l’exe crypté et non pas celui décrypté ( ce qui serait
trop simple )<br>
La on à plusieurs choix , si vous parvenez a trouver le même crypteur utilisé
que pour l’original de ce programme, il vous suffira de re-crypté votre
version<span style="mso-spacerun: yes">  </span>cracké et ainsi de comparé la
version non-cracké avec la version cracké (les deux cryptés sous le même
cryptage&nbsp;: ASPack 2.00) afin de determiner les offset à modifié <span
style="mso-spacerun: yes"> </span>anisi ke leur valeur. <br>
N’ayant pas trouvé cette version d’ASPack et comme ca serait aussi trop simple
on va procéder autrement&nbsp;:<o:p></o:p></span></p>

<p style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:l0 level1 lfo2;
tab-stops:list 36.0pt'><![if !supportLists]><span style='color:silver'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='color:silver'>on va rechercher un endroit
inutilisé dans l‘executable (crypté) afin de pouvoir y ajouter des instructions<o:p></o:p></span></p>

<p style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:l0 level1 lfo2;
tab-stops:list 36.0pt'><![if !supportLists]><span style='color:silver'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='color:silver'>on va rechercher sous
SoftIce le moment (l’adresse) ou au demmarrage le programme s’est totalement
decrypté en mémoire<o:p></o:p></span></p>

<p style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:l0 level1 lfo2;
tab-stops:list 36.0pt'><![if !supportLists]><span style='color:silver'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='color:silver'>on va placer un jump à cette
adresse qui sautera vers des instructions que nous allons ajouté dans l’espace
libre<o:p></o:p></span></p>

<p style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:l0 level1 lfo2;
tab-stops:list 36.0pt'><![if !supportLists]><span style='color:silver'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='color:silver'>on va ecrire nos
instructions qui modifieront le programme qui sera alors sous la forme decrypté<o:p></o:p></span></p>

<p style='margin-left:36.0pt;text-indent:-18.0pt;mso-list:l0 level1 lfo2;
tab-stops:list 36.0pt'><![if !supportLists]><span style='color:silver'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='color:silver'>à la fin de celles-ci on
replacera un jump qui retournera au code normal afin de suivre le deroulement
du prog <o:p></o:p></span></p>

<p><b><u>Rechercher un endroit inutilisé&nbsp;:<o:p></o:p></u></b></p>

<p><span style='color:silver'>Pour cela on se sert d’un éditeur hexadecimal
classique, comme HexWorkShop.<br>
On ouvre le programme (crypté je rappelle) et on cherche un espace inutilisé&nbsp;assez
grands pour contenir quelques lignes de code ; Les endroits libres sont les séries
de 00 dans le fichier.<br>
On note l’adresse ou commence cette suite de 00, c’est la que l’on va ajouter
nos instructions.<o:p></o:p></span></p>

<p><span style='color:silver'>Pour ce tutorial j’ai pris choisi l’offset </span><b>69070
</b><span style='color:silver'>.<o:p></o:p></span></p>

  <p><b><u>Rechercher sous SoftIce le moment (l’adresse) ou le prog a fini de 
    se décrypter<o:p></o:p></u></b></p>

<p><span style='color:silver'>C’est la partie la plus longue et la plus
subtile.<br>
En effet, le programme va se décrypté en mémoire et une fois cela accomplie il
va sauter vers son déroulement normal.<br>
C’est ce moment matérialisé par une adresse que l’on doit trouvé, pour cela l’expérience
et une bonne analyse sont les seules armes dont vous disposez.<o:p></o:p></span></p>

<p><span style='color:silver'>Le programme se decypte par une suite d’instructions
qui ont été ajoutés lors de son cryptage. Ce sont en fait une ou plusieurs
boucles qui vont parcourir le listing en y remplaçant les valeurs Hexa crypté par
elle qui represente le listing original decrypté . Une fois le listing
totalement décrypté on sort de la boucle et on saute vers le debut du programme
qui va s’executer normalement.<o:p></o:p></span></p>

<p><span style='color:silver'>Par l’intermédiaire du Loader de soft-ice on
lance la programme, On atterrit à l’endroit ou le decryptage va commencé on à
plus qu’a tracer avec F10 <span style="mso-spacerun: yes"> </span>jusqu'à trouvé
le saut qui détermine la fin du décryptage.<o:p></o:p></span></p>

<p><span style='color:silver'>Il y’a pas mal de signes, différents selon le
type de cryptage, qui nous aident <span style="mso-spacerun: yes"> </span>à
repéré le début et la fin de cette séquence de décryptage&nbsp;:<o:p></o:p></span></p>

<p><span style='color:silver'>Bien sur il y’a beaucoup de variantes mais ce n’est
pas le but de ce tutorial de faire un listing de toutes les <span
style="mso-spacerun: yes"> </span>techniques employé.<br>
Pour Résumer en gros et faire une généralité&nbsp;la plupart commence par sauvegarder
tous les registres sur la pile par l’instruction </span><b>PUSHAD</b> , <span
style='color:silver'>ensuite on parcours des boucles facilement identifiables
puisque les instructions se répètent plusieurs fois, et on fini par restaurer
les registres par l’instruction </span><b>POPAD </b><span style='color:silver'>et
tout de suite après on saute vers le déroulement classique du prog.<o:p></o:p></span></p>

<p><span style='color:silver'><span style="mso-spacerun: yes"> </span>C’est
exactement ce que fais ce Programme&nbsp;:<o:p></o:p></span></p>

<p><span style='color:silver'>Le loader break sur la premiere instruction qui
est <span style="mso-spacerun: yes"> </span>PUSHAD.<br>
Il parcours ensuites quelques boucles (j’ai pas compté mais 2 ou 3)<br>
Apres il <span style="mso-spacerun: yes"> </span>restaure les registres avec
POPAD<br>
Et saute vers le debut des instructions de d’execution du prog<o:p></o:p></span></p>

<p><span style='color:silver'>On note cette adresse ainsi que l’adresse ou sautera
le jump&nbsp;: <o:p></o:p></span></p>

<p><b><span style='color:#99CCFF'>005314F4 jnz 005314FE <o:p></o:p></span></b></p>

<p><b><u>Placer un jump à cette adresse afin de sauter vers nos instructions<o:p></o:p></u></b></p>

<p><span style='color:silver'>Sous Hiew <span style="mso-spacerun:
yes"> </span>cette instruction est sous cette forme la&nbsp;(les adresses ont
été convertis) : .005314F4 jne <span style="mso-spacerun:
yes"> </span>.00067EFE (c’est cette adresse converti k’il faudra indiké)<o:p></o:p></span></p>

<p><span style='color:silver'>On remplace donc celle-ci par&nbsp;:</span><b><o:p></o:p></b></p>

<p><b>005314FA jmp 69070 <span style="mso-spacerun: yes">   </span>//</b><b><span
style='color:silver'> </span></b><span style='color:silver'>69070 étant l’offset
ou commencera nos instructions<b><o:p></o:p></b></span></p>

<p><span style='color:silver'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p><b><u>Ecrire nos instructions qui modifieront le programme qui sera alors sous
la forme decrypté<o:p></o:p></u></b></p>

<p><span style='color:silver'>Toujours sous Hiew on se rend à l’offset 69070<o:p></o:p></span></p>

<p><span style='color:silver'>Et on tape nos instructions qui vont modifier les
3 adresses que nous avons relevé pour réaliser le crack&nbsp;:<o:p></o:p></span></p>

<p><span style='color:silver'>MOV al,01<span style="mso-spacerun: yes">  
</span><span style="mso-spacerun: yes">                </span>// place dans al
la valeur 01 (la bonne valeur qui nous met registred héhé)<br>
MOV [4D2D5A],al<span style="mso-spacerun: yes">      </span>// remplace l’adresse
4D2D5A le 00 par le contenu de al =&gt; 01<br>
MOV [4D2D63],al<br>
MOV [4D2D6C],al<br>
JMP <span style="mso-spacerun: yes">  </span>67EFE<span style="mso-spacerun:
yes">                  </span>// </span><b><u>Saute vers le deroulement normal
du prog</u></b><span style='color:silver'><o:p></o:p></span></p>

<p><span style='color:silver'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p><span style='color:silver'>Y oila, on test et c Registered, <o:p></o:p></span></p>

<p><span style='color:silver'>Ne reste plus avec l’aide d’un patcheur de créer un
Patch en comparant le fichier original et celui que nous venons de faire Et
nous aurons realiser un Vrai patch qui modifiera bien l’exécutable crypté.<o:p></o:p></span></p>

  <p><span style='color:silver'>Sur ce, la pratique pour ce genre de crack est primordiale 
    et c’est par l’exeprience que vous aurez de plus en plus de faciliter à contourner 
    ce genre de protection qui à tendance a se généralisé.<o:p></o:p></span></p>
  <p><span style='color:silver'><o:p></o:p></span></p>


<p>&nbsp;</p>

  <p align="center">&nbsp;</p>

<p>&nbsp;</p>
</div>

</body>

</html>
